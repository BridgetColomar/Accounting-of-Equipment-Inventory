<Window x:Class="AccountingOfEquipmentInventoryManagementApp.Views.Windows.ManagerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AccountingOfEquipmentInventoryManagementApp.ViewModels"
        WindowStyle="None" AllowsTransparency="True"  Title="Менеджер" Height="750" Width="1100">

    <Window.DataContext>
        <local:ManagerViewModel />
    </Window.DataContext>
    <Grid>
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <!-- 1. Добавление новой категории оборудования -->
        <GroupBox Header="Добавление новой категории оборудования" Grid.Row="0" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="10">
                <Label Content="Название категории:" VerticalAlignment="Center" Margin="5"/>
                <TextBox Text="{Binding NewCategoryName, UpdateSourceTrigger=PropertyChanged}" Width="200" Margin="5"/>
                <Button Content="Создать категорию" Width="160" Margin="5" Command="{Binding AddCategoryCommand}"/>
            </StackPanel>
        </GroupBox>
            <Grid  Height="48" VerticalAlignment="Top" MouseLeftButtonDown="CustomTitleBar_MouseLeftButtonDown">
                <StackPanel Orientation="Horizontal"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        Margin="0,5,5,0"
        Panel.ZIndex="999">
                    <Button Width="30" Height="30" Content="−"
        Command="{Binding WindowControls.MinimizeCommand}"
        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
        ToolTip="Свернуть"/>
                    <Button Width="30" Height="30" Content="☐"
        Command="{Binding WindowControls.MaximizeCommand}"
        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
        ToolTip="Развернуть"/>
                    <Button Width="30" Height="30" Content="✖"
        Command="{Binding WindowControls.CloseCommand}"
        CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
        ToolTip="Закрыть"/>
                </StackPanel>
            </Grid>
            <!-- 2. Добавить оборудование -->
        <GroupBox Header="Добавить оборудование" Grid.Row="1" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="250"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="250"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
               
                <!-- ID оборудования (только для чтения) -->
                <Label Grid.Row="0" Grid.Column="0" Content="ID оборудования:" Margin="5" VerticalAlignment="Center"/>
                <TextBox Text="{Binding EquipmentId}" Grid.Row="0" Grid.Column="1" Margin="5" IsReadOnly="True"/>

                <!-- Наименование и Серийный номер -->
                <Label Grid.Row="1" Grid.Column="0" Content="Наименование:" Margin="5" VerticalAlignment="Center"/>
                <TextBox Text="{Binding EquipmentName, UpdateSourceTrigger=PropertyChanged}" Grid.Row="1" Grid.Column="1" Margin="5"/>
                <Label Grid.Row="1" Grid.Column="2" Content="Серийный номер:" Margin="5" VerticalAlignment="Center"/>
                <TextBox Text="{Binding SerialNumber, UpdateSourceTrigger=PropertyChanged}" Grid.Row="1" Grid.Column="3" Margin="5"/>

                <!-- Ряд 2: Статус и Категория -->
                <Label Grid.Row="2" Grid.Column="0" Content="Статус:" Margin="5" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="2" Grid.Column="1" Margin="5" ItemsSource="{Binding EquipmentStatuses}" SelectedItem="{Binding SelectedStatus, Mode=TwoWay}" />
                <Label Grid.Row="2" Grid.Column="2" Content="Категория:" Margin="5" VerticalAlignment="Center"/>
                <ComboBox x:Name="cbEquipmentCategory" Grid.Row="2" Grid.Column="3" Margin="5" ItemsSource="{Binding EquipmentCategories}" SelectedItem="{Binding SelectedCategory, Mode=TwoWay}" DisplayMemberPath="Name" />

                <!-- Дата покупки -->
                <Label Grid.Row="3" Grid.Column="0" Content="Дата покупки:" Margin="5" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding PurchaseDate}" Grid.Row="3" Grid.Column="1" Margin="5"/>

                <!-- Местоположение -->
                <Label Grid.Row="4" Grid.Column="0" Content="Местоположение:" Margin="5" VerticalAlignment="Center"/>
                <ComboBox ItemsSource="{Binding Locations}" SelectedItem="{Binding SelectedLocation}" Grid.Row="4" Grid.Column="1" Margin="5"/>

                <!-- Изображение оборудования -->
                <Label Grid.Row="5" Grid.Column="0" Content="Изображение:" Margin="5" VerticalAlignment="Center"/>
                <Button Content="Выбрать изображение" Command="{Binding SelectImageCommand}" Grid.Row="5" Grid.Column="1" Margin="5"/>

                <!-- Кнопки добавления и удаления -->
                <Grid Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="4" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Button Content="Добавить оборудование" Command="{Binding AddEquipmentCommand}" Width="160" Margin="0,0,10,0" HorizontalAlignment="Left" Grid.Column="0"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Column="1">
                        <Button Content="Удалить оборудование" Command="{Binding DeleteEquipmentCommand}" Width="160" Margin="0,0,10,0"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </GroupBox>

        <!-- 3. Отчет по оборудованию -->
        <GroupBox Header="Отчет по оборудованию" Grid.Row="2" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10">
                <Label Content="Начальная дата:" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding ReportStartDate}" Width="120" Margin="5,0,10,0"/>
                <Label Content="Конечная дата:" VerticalAlignment="Center"/>
                <DatePicker SelectedDate="{Binding ReportEndDate}" Width="120" Margin="5,0,10,0"/>
                <Label Content="Категория:" VerticalAlignment="Center"/>
                <ComboBox ItemsSource="{Binding EquipmentCategories}" SelectedItem="{Binding SelectedReportCategory}" Width="120" Margin="5,0,10,0" DisplayMemberPath="Name"/>
                <Button Content="Сформировать отчет" Command="{Binding GenerateReportCommand}" Width="140" Margin="0,0,10,0"/>
                <Button Content="Экспорт" Command="{Binding ExportCommand}" Width="140" Margin="0,0,10,0"/>
            </StackPanel>
        </GroupBox>

        <!-- 4. DataGrid для отображения списка оборудования -->
        <DataGrid ItemsSource="{Binding EquipmentReport}" Grid.Row="3" AutoGenerateColumns="False" IsReadOnly="True" SelectedItem="{Binding SelectedEquipment}" Cursor="">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                <DataGridTextColumn Header="Наименование" Binding="{Binding Name}" Width="*"/>
                <DataGridTextColumn Header="Серийный номер" Binding="{Binding SerialNumber}" Width="150"/>
                <DataGridTextColumn Header="Статус" Binding="{Binding Status}" Width="100"/>
                <DataGridTextColumn Header="Категория" Binding="{Binding Category.Name}" Width="150"/>
                <DataGridTextColumn Header="Дата покупки" Binding="{Binding PurchaseDate, StringFormat=\{0:dd.MM.yyyy\}}" Width="150"/>
                <DataGridTextColumn Header="Местоположение" Binding="{Binding Location}" Width="150"/>
                <!-- Добавляем новый столбец для показа кнопки с изображением -->
                <DataGridTemplateColumn Header="Изображение" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Просмотр" 
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             Command="{Binding DataContext.ViewImageCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                             CommandParameter="{Binding Image}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
    </Grid>
</Window>